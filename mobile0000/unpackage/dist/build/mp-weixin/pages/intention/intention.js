(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/intention/intention"],{"1f39":function(n,t,e){"use strict";e.r(t);var i=e("b084"),o=e("5dd0");for(var a in o)"default"!==a&&function(n){e.d(t,n,(function(){return o[n]}))}(a);e("ade8");var r,u=e("f0c5"),c=Object(u["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],r);t["default"]=c.exports},"21f4":function(n,t,e){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(e("a34a"));function o(n){return n&&n.__esModule?n:{default:n}}function a(n,t,e,i,o,a,r){try{var u=n[a](r),c=u.value}catch(s){return void e(s)}u.done?t(c):Promise.resolve(c).then(i,o)}function r(n){return function(){var t=this,e=arguments;return new Promise((function(i,o){var r=n.apply(t,e);function u(n){a(r,i,o,u,c,"next",n)}function c(n){a(r,i,o,u,c,"throw",n)}u(void 0)}))}}var u=function(){e.e("components/uni-load-more/uni-load-more").then(function(){return resolve(e("0e49"))}.bind(null,e)).catch(e.oe)},c=function(){e.e("components/empty").then(function(){return resolve(e("3004"))}.bind(null,e)).catch(e.oe)},s={components:{uniLoadMore:u,empty:c},data:function(){return{tabCurrentIndex:0,allIntentions:[],navList:[{flags:8,page:1,text:"全部",loadingType:"more",intentionList:[]},{flags:1,page:1,text:"已分配",loadingType:"more",intentionList:[]},{flags:2,page:1,text:"已完成",loadingType:"more",intentionList:[]},{flags:3,page:1,text:"已取消",loadingType:"more",intentionList:[]}]}},onLoad:function(n){this.tabCurrentIndex=0,8===n.flags&&this.loadData()},methods:{loadData:function(n){var t=this;return r(i.default.mark((function e(){var o,a,r,u,c,s,f;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o=t.tabCurrentIndex,a=t.navList[o],r=a.flags,"tabChange"!==n||!0!==a.loaded){e.next=5;break}return e.abrupt("return");case 5:if("loading"!==a.loadingType){e.next=7;break}return e.abrupt("return");case 7:return a.loadingType="loading",e.next=10,t.getIntentions();case 10:u=e.sent,c=[],f=0;case 13:if(!(f<u.length)){e.next=21;break}return e.next=16,t.getIntentionDetails(u[f].id);case 16:s=e.sent,c.push({info:u[f],detail:s});case 18:f++,e.next=13;break;case 21:console.log(c),setTimeout((function(){var n=c.filter((function(n){return n=Object.assign(n,t.intentionflagsExp(n.info.flags)),8===r?n:n.info.flags===r}));n.forEach((function(n){a.intentionList.push(n)})),t.$set(a,"loaded",!0),a.loadingType="more"}),600);case 23:case"end":return e.stop()}}),e)})))()},changeTab:function(n){this.tabCurrentIndex=n.target.current,this.loadData("tabChange")},tabClick:function(n){this.tabCurrentIndex=n},finishIntention:function(t){var e=this;new Promise((function(i){n.request({header:{"content-type":"application/JSON"},url:e.api.ApiRoot+"intentions/"+t.info.id+"/",data:{id:t.info.intention.id,serial_number:t.info.intention.serial_number,flags:3,name:t.info.intention.name,phone:t.info.intention.phone,country:t.info.intention.country,province:t.info.intention.province,city:t.info.intention.city,address:t.info.intention.address,postcode:t.info.intention.postcode,message:t.info.intention.message,quantity:t.info.intention.quantity,wx_open_id:t.info.intention.wx_open_id,wx_union_id:t.info.intention.wx_union_id,wx_name:t.info.intention.wx_name,wx_mobile:t.info.intention.wx_mobile,wx_avatar_url:t.info.intention.wx_avatar_url},method:"PUT",success:function(t){console.log(t.data),n.showModal({title:"提示",content:"留言订单已完成！"})},fail:function(n){console.log(n)}})})).catch((function(n){}))},deleteIntention:function(t){var e=this;n.showLoading({title:"请稍后"}),setTimeout((function(){e.navList[e.tabCurrentIndex].intentionList.splice(t,1),n.hideLoading()}),600)},getIntentions:function(){var t=this;return new Promise((function(e){n.request({header:{"content-type":"application/x-www-form-urlencoded"},url:t.api.ApiRoot+"intention_assignment/",data:{uid:n.getStorageSync("userDetail").id},method:"GET",success:function(n){e(n.data)},fail:function(n){console.log(n)}})})).catch((function(n){}))},getIntentionDetails:function(t){var e=this;return new Promise((function(i){n.request({header:{"content-type":"application/x-www-form-urlencoded"},url:e.api.ApiRoot+"intentions/"+t+"/details",method:"GET",success:function(n){i(n.data)},fail:function(n){console.log(n)}})})).catch((function(n){}))},intentionflagsExp:function(n){var t="",e="#fa436a";switch(+n){case 1:t="已分配";break;case 2:t="已完成";break;case 3:t="已取消";break;case 9:t="订单已关闭",e="#909399";break}return{flagsTip:t,flagsTipColor:e}},navToDetailPage:function(t){var e=t;n.navigateTo({url:"/pages/intention/intentionDetail?data=".concat(encodeURIComponent(JSON.stringify(e)))})}}};t.default=s}).call(this,e("543d")["default"])},"29b3":function(n,t,e){},"5dd0":function(n,t,e){"use strict";e.r(t);var i=e("21f4"),o=e.n(i);for(var a in i)"default"!==a&&function(n){e.d(t,n,(function(){return i[n]}))}(a);t["default"]=o.a},ade8:function(n,t,e){"use strict";var i=e("29b3"),o=e.n(i);o.a},b084:function(n,t,e){"use strict";e.d(t,"b",(function(){return o})),e.d(t,"c",(function(){return a})),e.d(t,"a",(function(){return i}));var i={uniLoadMore:function(){return e.e("components/uni-load-more/uni-load-more").then(e.bind(null,"0e49"))}},o=function(){var n=this,t=n.$createElement;n._self._c},a=[]},c86a:function(n,t,e){"use strict";(function(n){e("351e"),e("921b");i(e("66fd"));var t=i(e("1f39"));function i(n){return n&&n.__esModule?n:{default:n}}n(t.default)}).call(this,e("543d")["createPage"])}},[["c86a","common/runtime","common/vendor"]]]);