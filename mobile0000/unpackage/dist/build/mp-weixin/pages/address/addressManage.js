(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/address/addressManage"],{1079:function(e,t,a){"use strict";var n=a("8dc3"),i=a.n(n);i.a},"6b66":function(e,t,a){"use strict";(function(e){a("351e"),a("921b");n(a("66fd"));var t=n(a("fcdd"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("543d")["createPage"])},"7f49":function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){Promise.all([a.e("common/vendor"),a.e("components/pick-regions/pick-regions")]).then(function(){return resolve(a("01bc"))}.bind(null,a)).catch(a.oe)},i={components:{pickRegions:n},data:function(){return{region:[],defaultRegion:["广东省","广州市","番禺区"],defaultRegionCode:"440113",addressData:{id:0,contact_name:"",contact_phone:"",country:"中国",province:"",city:"",address:"",postcode:"",user:0},default_address:0,checked:!1,manageType:"edit"}},computed:{regionName:function(){return this.region.map((function(e){return e.name})).join(" ")}},onLoad:function(t){var a="新增收货地址";this.addressData.user=e.getStorageSync("userDetail").id,"edit"==t.type&&(a="编辑收货地址",this.addressData=JSON.parse(t.data),this.addressData.user=e.getStorageSync("userDetail").id),this.manageType=t.type,this.default_address=e.getStorageSync("userDetail").address_id,e.setNavigationBarTitle({title:a})},methods:{handleGetRegion:function(e){this.region=e,this.addressData.province=this.region[0].name,this.addressData.city=this.region[1].name},switchChange:function(e){this.checked=e.detail.value,console.log("switch 开关状态"),console.log(this.checked)},deleteAddress:function(t){var a=this;e.showModal({title:"提示",content:"确定要删除此地址么？",success:function(n){a.util.request(a.api.ApiRoot+"users/"+e.getStorageSync("userDetail").id+"/addresses/"+t+"/",{},"DELETE").then(e.navigateBack())}})},setDefaultAddress:function(){},confirm:function(t){var a=this,n=this.addressData;if(n.contact_name)if(/(^1[3|4|5|7|8][0-9]{9}$)/.test(n.contact_phone)){var i=this;if("edit"==i.manageType){console.log(this.addressData.id);var o=this.addressData.id,s=this.checked;new Promise((function(t){e.request({header:{"content-type":"application/json"},url:a.api.ApiRoot+"users/"+e.getStorageSync("userDetail").id+"/addresses/"+a.addressData.id+"/",data:n,method:"PUT",success:function(t){console.log(t);var a=e.getStorageSync("userDetail");a.address_id=o,e.setStorageSync("userDetail",a),1==s&&e.request({header:{"content-type":"application/json"},url:i.api.ApiRoot+"users/"+e.getStorageSync("userDetail").id+"/",data:{id:e.getStorageSync("userDetail").id,wx_open_id:e.getStorageSync("userDetail").wx_open_id,wx_union_id:e.getStorageSync("userDetail").wx_union_id,wx_name:e.getStorageSync("userDetail").wx_name,wx_avatar_url:e.getStorageSync("userDetail").wx_avatar_url,name:e.getStorageSync("userDetail").name,gender:e.getStorageSync("userDetail").gender,phone:e.getStorageSync("userDetail").phone,email:e.getStorageSync("userDetail").email,address_id:n.id,flags:e.getStorageSync("userDetail").id},method:"PUT",success:function(t){e.showToast({title:"修改默认地址",content:"默认地址已修改！"}),e.navigateBack({})},fail:function(t){console.log(t),e.showToast({title:"修改默认地址",content:"默认地址修改失败！"}),e.navigateBack({})}}),e.navigateBack({})},fail:function(e){console.log(e)}})})).catch((function(e){}))}else new Promise((function(t){e.request({header:{"content-type":"application/json"},url:i.api.ApiRoot+"users/"+e.getStorageSync("userDetail").id+"/addresses/",data:n,method:"POST",success:function(t){if(201==t.statusCode){var a=e.getStorageSync("userDetail");a.address_id=t.data.id,e.setStorageSync("userDetail",a),e.request({header:{"content-type":"application/json"},url:i.api.ApiRoot+"users/"+e.getStorageSync("userDetail").id+"/",data:{id:e.getStorageSync("userDetail").id,wx_open_id:e.getStorageSync("userDetail").wx_open_id,wx_union_id:e.getStorageSync("userDetail").wx_union_id,wx_name:e.getStorageSync("userDetail").wx_name,wx_avatar_url:e.getStorageSync("userDetail").wx_avatar_url,name:e.getStorageSync("userDetail").name,gender:e.getStorageSync("userDetail").gender,phone:e.getStorageSync("userDetail").phone,email:e.getStorageSync("userDetail").email,address_id:t.data.id,flags:e.getStorageSync("userDetail").id},method:"PUT",success:function(t){e.showToast({title:"地址生成",content:"地址已经添加！"}),e.navigateBack({})},fail:function(t){console.log(t),e.showToast({title:"地址生成",content:"地址添加失败！"}),e.navigateBack({})}})}e.navigateBack({})},fail:function(e){console.log(e)}})})).catch((function(e){}))}else e.showModal({title:"提示",content:"请输入正确的手机号码",success:function(e){}});else e.showModal({title:"提示",content:"请填写收货人姓名",success:function(e){}})}}};t.default=i}).call(this,a("543d")["default"])},"8dc3":function(e,t,a){},d0f3:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return n}));var n={pickRegions:function(){return Promise.all([a.e("common/vendor"),a.e("components/pick-regions/pick-regions")]).then(a.bind(null,"01bc"))}},i=function(){var e=this,t=e.$createElement;e._self._c},o=[]},d786:function(e,t,a){"use strict";a.r(t);var n=a("7f49"),i=a.n(n);for(var o in n)"default"!==o&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},fcdd:function(e,t,a){"use strict";a.r(t);var n=a("d0f3"),i=a("d786");for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("1079");var s,r=a("f0c5"),c=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);t["default"]=c.exports}},[["6b66","common/runtime","common/vendor"]]]);